I made part 2 harder than it shoud've been.
I was too deep in my logic when I trully understood the problem.
There is a way to solve both parts in a easier way, specially part 2.